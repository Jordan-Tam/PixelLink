<header>
    <a href="/home" id="goBack">â‡¦ Return to home page</a>

    <h1> {{user.username}}'s profile </h1>
</header>
<main>
    {{#if loggedInUser}} <!-- Will be set to true if the person viewing profile is viewing their own profile-->   
    <div>
        <h3> Change account information </h3>

        <form action="/{{user._id}}" method="POST">
        <p id="error" {{hidden}}>{{error_message}}</p>
        <ul>
            <li> Username: {{user.username}}
                <label for="change_uname">Change Username?</label>
                <input type="text" id="change_uname" name="change_uname">
            </li> 
            <li> 
                <label for="change_password">Change Password?</label>
                <input type="text" id="change_password" name="change_password">
            </li> 
        </ul>
        <input type="submit" value="Make changes">
        </form>
    </div>
    {{else}}
    <div>
        {{#if notFriended}}
        <form action = "{{user._id}}/friends" method="POST">
            <input type="hidden" name="friendId" value="{{user._id}}">
            <input type="submit" value="Add {{user.username}}">
        </form>
        {{else}}
         <form action = "{{user._id}}/friends" method="POST">
            <input type="hidden" name="_method" value="DELETE">
            <input type="hidden" name="friendId" value="{{user._id}}">
            <input type="submit" value="Remove {{user.username}}">
        </form>
        {{/if}}
    </div>
    {{/if}}

    <br>

    <div>
        <h3> Friends: <a href="/users/{{user._id}}/friends" > {{user.friends.length}}</a> </h3>
    </div>

    <div>
        <h3> Games: </h3>
        {{#if user.games}}
        <ul>
            {{#each user.games}}
            <li> 
                <a href="/game/{{this.gameId}}">{{this.gameName}}</a>
                <ul>
                {{#each this.userGameInfo}}
                <li>{{this.field_name}}: {{this.value}}</li>
                {{/each}}
                </ul>
            </li>
             {{/each}}
        </ul>
        {{else}}
        No games.
        {{/if}}
    </div>

    <br>

    <div>
        <h3> Comments: </h3>
        {{#if user.comments.length}}
        <ul>
            {{#each user.comments}}
            <li>
                <!-- Commenter Name Here? -->
                <p>{{this.content}}</p>
                <h4>{{this.date}} | {{this.time}}</h4>
            </li>
            {{#if loggedInUser}}
            <form action="{{user._id}}/comment/{{this._id}}" method="POST">
                <input type="hidden" name="_method" value="DELETE">
                <input type="submit" value = "delete comment">
            </form>
            {{/if}}
            
            {{/each}}
        </ul>
        {{else}}
        No comments.
        {{/if}}
        <form action="/{{user._id}}/comment" method="POST"> 
            <input type="text" id="addComment" name="addComment">
            <input type="submit" value="add comment!">
        </form> 
    </div>
</main>