<header>
    <a href="/home" id="goBack">⇦ Return to home page</a>

    <h1> {{user.username}}'s profile </h1>
</header>
<main>

    <!-- If this profile belongs to the user currently logged in, display elements to change account information. -->
    {{#if loggedInUser}}
    <div id="changeAccountInfo-div">

        <form {{!-- action="/" method="POST" --}}>
            <input type="submit" value="Change Username">
        </form>

        <form {{!-- action="/" method="POST" --}}>
            <input type="submit" value="Change Password">
        </form>

        {{!-- <form action="/{{user._id}}" method="POST">
        <p id="error" {{hidden}}>{{error_message}}</p>
        <ul>
            <li> Username: {{user.username}}
                <label for="change_uname">Change Username?</label>
                <input type="text" id="change_uname" name="change_uname">
            </li> 
            <li> 
                <label for="change_password">Change Password?</label>
                <input type="text" id="change_password" name="change_password">
            </li> 
        </ul>
        <input type="submit" value="Make changes">
        </form> --}}

    </div>

    <!-- If this profile does NOT belong to the user currently logged in, display a button to follow/unfollow the user (depends on whether the user is already following this profile or not). -->
    {{else}}
    <div>
        {{#if notFriended}}
        <form action = "{{user._id}}/friends" method="POST">
            <input type="hidden" name="friendId" value="{{user._id}}">
            <input type="submit" value="Add {{user.username}}">
        </form>
        {{else}}
         <form action = "{{user._id}}/friends" method="POST">
            <input type="hidden" name="_method" value="DELETE">
            <input type="hidden" name="friendId" value="{{user._id}}">
            <input type="submit" value="Remove {{user.username}}">
        </form>
        {{/if}}
    </div>
    {{/if}}

    <div>
        <h3> Following: <a href="/users/{{user._id}}/friends" > {{user.friends.length}}</a> </h3>
        <h3> Followers: <a href="/users/{{user._id}}/friends" > {{user.followers.length}}</a> </h3>
    </div>

    <div>
        <h3> Games: </h3>
        {{#if user.games}}
        <ul>
            {{#each user.games}}
            <li> 
                <a href="/game/{{this.gameId}}">{{this.gameName}}</a>
                <ul>
                {{#each this.userGameInfo}}
                <li>{{this.field_name}}: {{this.value}}</li>
                {{/each}}
                </ul>
            </li>
             {{/each}}
        </ul>
        {{else}}
        No games.
        {{/if}}
    </div>

    <br>

    <div>
        <h3> Comments: </h3>
        {{#if user.comments.length}}
            {{#each user.comments}}
                <div class="commentDiv">
                    <p class="usernameParagraph">{{this.username}}</p>
                    <p class="dateTimeParagraph">{{this.date}} • {{this.time}}</p>
                    <p class="contentParagraph">{{this.content}}</p>
                </div>
                {{#if loggedInUser}}
                <form action="{{user._id}}/comment/{{this._id}}" method="POST">
                    <input type="hidden" name="_method" value="DELETE">
                    <input type="submit" value = "delete comment">
                </form>
                {{/if}}
            {{/each}}
        {{else}}
            No comments.
        {{/if}}
        <form action="/{{user._id}}/comment" method="POST"> 
            <input type="text" id="addComment" name="addComment">
            <input type="submit" value="add comment!">
        </form> 
    </div>
</main>